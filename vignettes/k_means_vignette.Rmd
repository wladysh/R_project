---
title: "k_means_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{k_means_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(haufenR)
```

```{r example-data-1}
#Random Clusters
set.seed(123)
X <- rbind(matrix(rnorm(50*2, mean = 0), ncol = 2),
           matrix(rnorm(50*2, mean = 3), ncol = 2),
           matrix(rnorm(50*2, mean = 6), ncol = 2))
head(X)
set.seed(123)
res <- k_means(X, K = 3)
res$centers
table(res$clusters)

plot(X, col = res$clusters, pch = 19, main = "k-means Cluster")
points(res$centers, col = 1:3, pch = 8, cex = 2)
```

```{r example-data-2}
## Comparison to kmeans
set.seed(123)
res_r <- kmeans(X, centers=3)
par(mfrow=c(1,2))


res$centers
res_r$centers #Same (with same seed)

plot(X, col = res$clusters, pch = 19, main = "Own k_means")
points(res$centers, col = 1:3, pch = 8, cex = 2)

plot(X, col = res$clusters, pch = 19, main = "R k_means")
points(res_r$centers, col = 1:3, pch = 8, cex = 2)
```

```{r example-data-3}
X2 <- rbind(matrix(rnorm(302, mean = 0), ncol = 2),
           matrix(rnorm(502, mean = 5), ncol = 2))
res2 <- k_means(X, K = 2)
plot(X2, col = res2$clusters, pch=19)
points(res2$centers, col = 1:2, pch = 8, cex = 2)

```